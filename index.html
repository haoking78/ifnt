<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>IFNT · 無限翻轉人生 v6.4.1-20251031-3</title>
  <meta name="theme-color" content="#0b2f3a"/>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="app_icon_192.png" sizes="192x192">
  <style>
    :root {
      --bg:#0b2f3a;
      --card:#103b48;
      --muted:#7aa0ac;
      --text:#eaf7fb;
      --accent:#19d0b7;
      --danger:#ff5d5d;
      --warn:#ffd15d;
      --ok:#34d399;
    }
    * { box-sizing:border-box; }
    html,body { margin:0; background:var(--bg); color:var(--text); font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans TC",Helvetica,Arial; }
    .wrap { max-width:880px; padding:20px; margin:0 auto; }
    header { display:flex; align-items:center; gap:12px; }
    header img { width:28px; height:28px; border-radius:6px; }
    h1 { font-size:22px; margin:0; }
    .ver { opacity:.8; font-size:12px; margin-left:6px; }
    .bar { display:flex; gap:10px; flex-wrap:wrap; margin:14px 0 10px; }
    .chip { padding:10px 14px; background:#0e3340; border-radius:999px; border:1px solid #1a4d5d; cursor:pointer; }
    .chip.active { background:#115061; }
    .card { background:var(--card); border:1px solid #1a4d5d; border-radius:14px; padding:16px; margin:12px 0 20px; }
    .row { display:flex; gap:12px; flex-wrap:wrap; }
    .col { flex:1 1 320px; min-width:260px; }
    label { display:block; font-size:12px; color:var(--muted); margin-bottom:6px; }
    input, select, textarea { width:100%; padding:14px 12px; border-radius:12px; border:1px solid #1a4d5d; background:#0f3642; color:var(--text); }
    input[type="date"] { width:100%; }
    textarea { min-height:120px; resize:vertical; }
    .btn { background:linear-gradient(180deg,#28e0c5,#14b9a1); border:0; color:#042127; padding:12px 16px; border-radius:12px; font-weight:700; cursor:pointer; }
    .btn.line { background:#134a5a; color:var(--text); border:1px solid #1a4d5d; }
    .btn.danger { background:#ff5d5d; color:white; }
    .grid { width:100%; border-collapse:collapse; margin-top:10px; }
    .grid th,.grid td { border-bottom:1px solid #1a4d5d; padding:12px; text-align:left; font-size:14px; }
    .pill { display:inline-block; padding:4px 8px; border-radius:999px; font-size:12px; }
    .pill.ok { background:#083d2f; color:var(--ok); border:1px solid #1a6f58; }
    .pill.warn { background:#402f08; color:#ffd15d; border:1px solid #80621a; }
    .pill.danger { background:#402020; color:#ff9a9a; border:1px solid #7a2f2f; }
    .note { font-size:12px; color:var(--muted); margin-top:8px; }
    .right { text-align:right; }
  </style>
</head>
<body>
<div class="wrap">
  <header>
    <img src="app_icon_192.png" alt="logo">
    <h1>IFNT · 無限翻轉人生</h1>
    <span class="ver">v6.4.1-20251031-3</span>
    <div style="flex:1"></div>
    <button class="btn line" id="exportCsvBtn">匯出 CSV</button>
  </header>

  <nav class="bar">
    <div class="chip active" data-tab="tab1">① 招募 1 人</div>
    <div class="chip" data-tab="tab2">② 零售＋自購 1500 BV</div>
    <div class="chip" data-tab="tab3">③ 家庭轉移消費 300 IBV</div>
    <div class="chip" data-tab="tab4">④ 312 互動名單</div>
  </nav>

  <!-- ① 招募 -->
  <section class="card" id="tab1">
    <div class="row">
      <div class="col">
        <label>日期</label>
        <input id="r_date" type="date">
      </div>
      <div class="col">
        <label>招募姓名</label>
        <input id="r_name" type="text" placeholder="輸入姓名">
      </div>
      <div class="col" style="align-self:end">
        <button class="btn" id="btnAddRecruit">新增招募</button>
      </div>
    </div>
    <div class="row">
      <div class="col"><div class="pill warn" id="r_count_pill">累計 0 / 目標 1</div></div>
    </div>
    <table class="grid" id="r_table">
      <thead><tr><th>#</th><th>日期</th><th>姓名</th><th class="right">操作</th></tr></thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- ② BV -->
  <section class="card" id="tab2" style="display:none">
    <div class="row">
      <div class="col">
        <label>日期</label>
        <input id="bv_date" type="date">
      </div>
      <div class="col">
        <label>顧客姓名（可留空）</label>
        <input id="bv_customer" list="names_datalist" placeholder="可留空或輸入">
      </div>
      <div class="col">
        <label>零售品項（自行輸入）</label>
        <input id="bv_item" placeholder="例如：平泰秀、OPC、NAD">
      </div>
      <div class="col">
        <label>零售 BV</label>
        <input id="bv_value" type="number" min="0" step="1" placeholder="數值">
      </div>
      <div class="col" style="align-self:end">
        <button class="btn" id="btnAddBV">新增 BV</button>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div id="bv_status" class="pill danger">小計 0 / 距離 1500</div>
      </div>
    </div>
    <table class="grid" id="bv_table">
      <thead><tr><th>#</th><th>日期</th><th>姓名</th><th>品項</th><th>BV</th><th class="right">操作</th></tr></thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- ③ IBV -->
  <section class="card" id="tab3" style="display:none">
    <div class="row">
      <div class="col">
        <label>日期</label>
        <input id="ibv_date" type="date">
      </div>
      <div class="col">
        <label>姓名（或自己）</label>
        <input id="ibv_person" list="names_datalist" placeholder="可留空或輸入">
      </div>
      <div class="col">
        <label>消費品項（自行輸入）</label>
        <input id="ibv_item" placeholder="例如：保健、家電、日用品">
      </div>
      <div class="col">
        <label>IBV</label>
        <input id="ibv_value" type="number" min="0" step="1" placeholder="數值">
      </div>
      <div class="col" style="align-self:end">
        <button class="btn" id="btnAddIBV">新增 IBV</button>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div id="ibv_status" class="pill danger">小計 0 / 距離 300</div>
      </div>
    </div>
    <table class="grid" id="ibv_table">
      <thead><tr><th>#</th><th>日期</th><th>姓名</th><th>品項</th><th>IBV</th><th class="right">操作</th></tr></thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- ④ 312 -->
  <section class="card" id="tab4" style="display:none">
    <div class="row">
      <div class="col">
        <label>居住縣市</label>
        <select id="i_city"></select>
      </div>
      <div class="col">
        <label>姓名（可選清單或自行輸入）</label>
        <input id="i_name" list="names_datalist" placeholder="輸入或選擇姓名">
      </div>
      <div class="col">
        <label>族群 / 關係</label>
        <input id="i_group" list="groups_datalist" placeholder="例如：國小同學、客戶、親戚">
      </div>
      <div class="col">
        <label>互動日期</label>
        <input id="i_date" type="date">
      </div>
    </div>
    <div class="row">
      <div class="col">
        <label>互動情況 / 備註（可輸入很多內容）</label>
        <textarea id="i_memo" placeholder="互動內容、需求、跟進事項…"></textarea>
      </div>
    </div>
    <div class="row">
      <div class="col"><button class="btn" id="btnAddInteract">新增 / 累加互動</button></div>
      <div class="col"><button class="btn line" id="btnClearInputs">清空欄位</button></div>
    </div>
    <table class="grid" id="i_table">
      <thead><tr><th>#</th><th>縣市</th><th>姓名</th><th>族群</th><th>最近互動日</th><th>次數</th><th class="right">操作</th></tr></thead>
      <tbody></tbody>
    </table>
    <p class="note">點「查看」可展開此人的所有互動紀錄。</p>
  </section>

  <datalist id="names_datalist"></datalist>
  <datalist id="groups_datalist"></datalist>

  <p class="note">資料僅儲存在你的裝置（localStorage）。如需備份請用上方「匯出 CSV」。</p>
</div>

<script src="app.js"></script>
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('./service-worker.js');
    });
  }
</script>
</body>
</html>
