<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>IFNT · 無限翻轉人生 v6.2.7</title>
<link rel="manifest" href="./manifest.json?v=20251031-5">
<link rel="icon" href="./app_icon_192.png?v=20251031-5">
<meta name="theme-color" content="#0b3440">
<link rel="stylesheet" href="./styles.css?v=20251031-5">
<script>
if('serviceWorker' in navigator){
  window.addEventListener('load',()=>{
    navigator.serviceWorker.register('./service-worker.js?v=20251031-5').then(reg=>{
      if(reg.waiting) reg.waiting.postMessage({type:'SKIP_WAITING'});
      navigator.serviceWorker.addEventListener('controllerchange',()=>location.reload());
    });
  });
}
</script>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <img src="./logo.png?v=20251031-5" alt="logo"><div class="h1">IFNT · 無限翻轉人生</div><div class="ver">v6.2.7</div>
      <button id="btnExport" class="btn" style="margin-left:auto">匯出 CSV</button>
      <button id="btnOpenSettings" class="btn ghost" style="margin-left:8px">設定</button>
    </div>

    <div class="tabs">
      <div class="tab active" data-tab="recruit">① 招募 1 人</div>
      <div class="tab" data-tab="bv">② 零售＋自購 1500 BV</div>
      <div class="tab" data-tab="ibv">③ 家庭轉移 300 IBV</div>
      <div class="tab" data-tab="list">④ 312 互動名單</div>
    </div>

    <section id="recruit" class="card">
      <div class="row"><div class="col"><label>日期</label><input id="rDate" type="date"></div>
      <div class="col"><label>招募姓名</label><input id="rName" placeholder="輸入姓名"></div></div>
      <div style="margin-top:10px;display:flex;gap:10px">
        <button id="btnAddRecruit" class="btn">新增招募</button>
        <button data-clear="recruit" class="btn ghost">清空欄位</button>
      </div>
      <div class="note">累計達 1 人即完成</div>
      <table class="grid" id="rTable"><thead><tr><th>#</th><th>日期</th><th>姓名</th><th>操作</th></tr></thead><tbody></tbody></table>
    </section>

    <section id="bv" class="card" style="display:none">
      <div class="section-title">② 零售＋自購 1500 BV <span id="bvBadge" class="badge badge-red">距離 1500</span></div>
      <div class="row">
        <div class="col"><label>日期</label><input id="bvDate" type="date"></div>
        <div class="col"><label>顧客姓名（可留空或輸入）</label><input id="bvName" placeholder="可留空或輸入" list="nameList"><datalist id="nameList"></datalist></div>
      </div>
      <div class="row">
        <div class="col"><label>零售品項（自行輸入）</label><input id="bvItem" placeholder="例如：平泰秀、OPC、NAD"></div>
        <div class="col"><label>零售 BV</label><input id="bvValue" type="number" inputmode="decimal" placeholder="數值"></div>
      </div>
      <div style="margin-top:10px;display:flex;gap:10px">
        <button id="btnAddBV" class="btn">新增 BV</button>
        <button data-clear="bv" class="btn ghost">清空欄位</button>
      </div>
      <table class="grid"><thead><tr><th>#</th><th>姓名</th><th>筆數</th><th>小計BV</th><th>操作</th></tr></thead><tbody id="bvTbody"></tbody></table>
    </section>

    <section id="ibv" class="card" style="display:none">
      <div class="section-title">③ 家庭轉移 300 IBV <span id="ibvBadge" class="badge badge-red">距離 300</span></div>
      <div class="row">
        <div class="col"><label>日期</label><input id="ibvDate" type="date"></div>
        <div class="col"><label>姓名（或自己）</label><input id="ibvName" placeholder="可留空或輸入" list="nameList"><datalist id="nameList2"></datalist></div>
      </div>
      <div class="row">
        <div class="col"><label>消費品項（自行輸入）</label><input id="ibvItem" placeholder="例如：保健、家電、日用品"></div>
        <div class="col"><label>IBV</label><input id="ibvValue" type="number" inputmode="decimal" placeholder="數值"></div>
      </div>
      <div style="margin-top:10px;display:flex;gap:10px">
        <button id="btnAddIBV" class="btn">新增 IBV</button>
        <button data-clear="ibv" class="btn ghost">清空欄位</button>
      </div>
      <table class="grid"><thead><tr><th>#</th><th>姓名</th><th>筆數</th><th>小計IBV</th><th>操作</th></tr></thead><tbody id="ibvTbody"></tbody></table>
    </section>

    <section id="list" class="card" style="display:none">
      <div class="row">
        <div class="col"><label>居住縣市</label><select id="city"></select></div>
        <div class="col"><label>姓名（可選清單或自行輸入）<span class="small-hint">⋯ 有記憶清單</span></label><input id="pName" placeholder="輸入或選擇姓名" list="nameList"><datalist id="nameList"></datalist></div>
      </div>
      <div class="row">
        <div class="col"><label>族群 / 關係</label><input id="pGroup" placeholder="例如：國小同學、客戶、親戚" list="groupList"><datalist id="groupList"></datalist></div>
        <div class="col"><label>互動日期</label><input id="pDate" type="date"></div>
      </div>
      <label>互動情況 / 備註（可輸入很多內容）</label>
      <textarea id="pNote" placeholder="互動內容、需求、跟進事項…"></textarea>
      <div style="margin-top:10px;display:flex;gap:10px">
        <button id="btnAddLog" class="btn">新增 / 累加互動</button>
        <button data-clear="list" class="btn ghost">清空欄位</button>
      </div>
      <table class="grid" id="peopleTable" style="margin-top:14px">
        <thead><tr><th>#</th><th>縣市</th><th>姓名</th><th>族群</th><th>最近互動日</th><th>次數</th><th>操作</th></tr></thead>
        <tbody></tbody>
      </table>
    </section>
  </div>

  <div id="settingsModal">
    <div class="box">
      <h3 style="margin:0 0 6px 0">目標設定</h3>
      <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:10px">
        <label style="flex:1 1 240px;display:block">
          <span style="font-size:13px;color:#bfe1e8">BV 目標</span>
          <input id="inpTargetBV" type="number" value="1500" style="width:100%;background:#0b2931;color:#e9f4f6;border:1px solid #1a525f;border-radius:10px;padding:10px">
        </label>
        <label style="flex:1 1 240px;display:block">
          <span style="font-size:13px;color:#bfe1e8">IBV 目標</span>
          <input id="inpTargetIBV" type="number" value="300" style="width:100%;background:#0b2931;color:#e9f4f6;border:1px solid #1a525f;border-radius:10px">
        </label>
      </div>
      <div style="margin-top:14px;display:flex;gap:8px;justify-content:flex-end">
        <button id="btnCloseSettings" class="btn ghost">取消</button>
        <button id="btnSaveSettings" class="btn">儲存</button>
      </div>
    </div>
  </div>

  <canvas id="fwCanvas"></canvas>
  <script src="./app.js?v=20251031-5" defer></script>
</body>
</html>
