<!doctype html>
<html lang="zh-Hant-TW">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>IFNT · 無限翻轉人生 v6.1.4</title>
  <meta name="theme-color" content="#0d2b3f" />
  <link rel="manifest" href="manifest.json?v=v6.1.4">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <style>
    :root {
      --bg:#061a26; --panel:#0f2736; --muted:#87b5d1; --text:#def2ff;
      --accent:#1ec8ff; --good:#35e58a; --bad:#ff6767; --warn:#ffd15c;
      --chip:#14384c; --ring:#2e5a76;
    }
    *{box-sizing:border-box}
    html,body{height:100%; background:radial-gradient(circle at 30% 10%, #0c2331, #061a26 60%); color:var(--text); margin:0; font-family: 'Noto Sans TC', 'Inter', system-ui, -apple-system, Segoe UI, Roboto, 'PingFang TC', 'Microsoft JhengHei', sans-serif;}
    header{display:flex;align-items:center;gap:12px;padding:12px 16px;position:sticky;top:0;background:linear-gradient(180deg,#061a26,rgba(6,26,38,.6));backdrop-filter:blur(6px);z-index:3;border-bottom:1px solid #0e3247}
    .logo{width:34px;height:34px;border-radius:8px;background:#000 url('icons/icon-192.png') center/90% no-repeat;box-shadow:0 0 0 1px var(--ring), 0 8px 18px rgba(0,0,0,.35)}
    h1{margin:0;font-size:18px;line-height:1.15;font-weight:800;letter-spacing:.5px}
    small.tag{display:block;color:var(--muted);font-size:12px;margin-top:2px}
    .wrap{max-width:980px;margin:0 auto;padding:0 14px 100px}
    .tabs{display:flex;gap:10px;flex-wrap:wrap;margin:8px 0 14px}
    .tab{padding:10px 14px;border-radius:999px;background:var(--chip);color:var(--muted);border:1px solid var(--ring);cursor:pointer;user-select:none}
    .tab.active{background:linear-gradient(180deg,#1b4054,#15394c);color:var(--text);box-shadow:inset 0 0 0 1px var(--ring)}
    section.card{background:linear-gradient(180deg,#0e2a3a,#0b2432);border:1px solid var(--ring);border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,.28);padding:14px;margin:14px 0}
    h2{margin:4px 0 10px;font-size:20px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .row3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
    @media(max-width:860px){ .row,.row3{grid-template-columns:1fr} }
    label.cap{display:block;color:var(--muted);font-size:12px;margin:6px 6px 6px 2px}
    input,select,textarea{width:100%;padding:14px;border-radius:12px;background:linear-gradient(180deg,#0c2331,#0a1e2a);border:1px solid var(--ring);color:var(--text)}
    textarea{min-height:96px;resize:vertical}
    .btn{padding:12px 16px;border-radius:12px;border:1px solid var(--ring);background:linear-gradient(180deg,#103248,#0e2b3d);color:var(--text);cursor:pointer}
    .btn.good{background:linear-gradient(180deg,#2de58e,#1bcf7a);color:#003021;border:1px solid #58f3a7}
    .row-actions{display:flex;gap:10px;justify-content:flex-end}
    .chip{padding:12px;border:1px dashed var(--ring);border-radius:12px;background:rgba(20,56,76,.35);text-align:center}
    .chip b{display:block;font-size:20px;margin-top:6px}
    .progress{height:8px;background:#0b2b3b;border-radius:999px;border:1px solid var(--ring);overflow:hidden}
    .bar{height:100%;background:linear-gradient(90deg,#2de58e,#1ec8ff)}
    .right{text-align:right}
  </style>
</head>
<body>
  <header>
    <div class="logo" aria-hidden="true"></div>
    <div>
      <h1>IFNT · 無限翻轉人生 <span>v6.1.4</span></h1>
      <small class="tag">本機儲存 · 可安裝為 App · 一鍵匯出 CSV</small>
    </div>
  </header>
  <div class="wrap">
    <div class="tabs" id="tabs">
      <div class="tab active" data-tab="recruit">① 招募 1 人</div>
      <div class="tab" data-tab="bv">② 零售＋自購 1500 BV</div>
      <div class="tab" data-tab="ibv">③ 家庭轉移消費 300 IBV</div>
      <div class="tab" data-tab="crm">④ 312 互動名單</div>
    </div>

    <!-- Recruit -->
    <section class="card" data-panel="recruit">
      <h2>① 親自招募 1 人 <span id="flagRecruit" class="chip" style="display:inline-block">未達標</span></h2>
      <div class="row">
        <div><label class="cap">日期</label><input type="date" id="rDate"></div>
        <div><label class="cap">招募姓名</label><input type="text" id="rName" placeholder="輸入姓名"></div>
      </div>
      <div class="row" style="align-items:end">
        <div><label class="cap">累計人數</label><div class="chip"><b id="rTotal">0</b></div></div>
        <div class="row-actions"><button class="btn good" id="btnAddRecruit">新增招募</button></div>
      </div>
      <div class="progress" style="margin-top:10px"><div class="bar" id="barRecruit" style="width:0%"></div></div>
      <table><thead><tr><th>#</th><th>日期</th><th>姓名</th><th class="right">操作</th></tr></thead><tbody id="rTable"></tbody></table>
    </section>

    <!-- BV -->
    <section class="card" data-panel="bv" hidden>
      <h2>② 零售＋自購 1500 BV <span id="flagBV" class="chip" style="display:inline-block">未達標</span></h2>
      <div class="row3">
        <div><label class="cap">日期</label><input type="date" id="bDate"></div>
        <div><label class="cap">顧客姓名</label><input type="text" id="bCustomer" placeholder="可選清單或自行輸入"></div>
        <div><label class="cap">零售品項（例如：平泰秀、OPC、NAD）</label><input type="text" id="bItem" placeholder="例如：平泰秀、OPC、NAD"></div>
      </div>
      <div class="row3">
        <div><label class="cap">BV（數值）</label><input type="number" id="bBV" step="1" min="0" placeholder="輸入 BV 數值"></div>
        <div class="row-actions"><button class="btn good" id="btnAddBV">新增 BV</button></div>
      </div>
      <div class="progress" style="margin-top:10px"><div class="bar" id="barBV" style="width:0%"></div></div>
      <div class="chip">目標：1500 BV ｜ 尚差 <b id="bRemain">1500</b></div>
      <table><thead><tr><th>#</th><th>日期</th><th>顧客</th><th>品項</th><th>BV</th><th class="right">操作</th></tr></thead><tbody id="bTable"></tbody></table>
    </section>

    <!-- IBV -->
    <section class="card" data-panel="ibv" hidden>
      <h2>③ 家庭轉移消費 300 IBV <span id="flagIBV" class="chip" style="display:inline-block">未達標</span></h2>
      <div class="row3">
        <div><label class="cap">日期</label><input type="date" id="iDate"></div>
        <div><label class="cap">姓名 / 自己</label><input type="text" id="iWho" placeholder="顧客姓名或自己"></div>
        <div><label class="cap">消費品項（自行輸入）</label><input type="text" id="iItem" placeholder="例如：清潔補充包、咖啡..."></div>
      </div>
      <div class="row3">
        <div><label class="cap">IBV（數值）</label><input type="number" id="iIBV" step="1" min="0" placeholder="輸入 IBV 數值"></div>
        <div class="row-actions"><button class="btn good" id="btnAddIBV">新增 IBV</button></div>
      </div>
      <div class="progress" style="margin-top:10px"><div class="bar" id="barIBV" style="width:0%"></div></div>
      <div class="chip">目標：300 IBV ｜ 尚差 <b id="iRemain">300</b></div>
      <table><thead><tr><th>#</th><th>日期</th><th>姓名</th><th>品項</th><th>IBV</th><th class="right">操作</th></tr></thead><tbody id="iTable"></tbody></table>
    </section>

    <!-- CRM -->
    <section class="card" data-panel="crm" hidden>
      <h2>④ 312 互動名單</h2>
      <div class="row3">
        <div><label class="cap">居住縣市</label><select id="cCity"></select></div>
        <div><label class="cap">姓名（可選清單或自行輸入）</label><input type="text" id="cName" list="nameList" placeholder="輸入或選擇姓名"><datalist id="nameList"></datalist></div>
        <div><label class="cap">族群 / 關係</label><input type="text" id="cGroup" list="groupList" placeholder="例如：國小同學、客戶、親戚"><datalist id="groupList"></datalist></div>
      </div>
      <div class="row3">
        <div><label class="cap">互動日期</label><input type="date" id="cDate"></div>
      </div>
      <div><label class="cap">互動情況 / 備註（可輸入很多內容）</label><textarea id="cNote" placeholder="互動內容、需求、跟進事項…"></textarea></div>
      <div class="row-actions" style="margin-top:10px">
        <button class="btn good" id="btnAddCRM">新增 / 累加互動</button>
        <button class="btn" id="btnClearForm">清空欄位</button>
      </div>
      <div id="crmSummary" style="margin-top:10px" class="chip">載入名單中…</div>
      <table><thead><tr><th>#</th><th>縣市</th><th>姓名</th><th>族群</th><th>最近互動日</th><th>次數</th><th>操作</th></tr></thead><tbody id="cTable"></tbody></table>
      <section class="card" style="margin-top:12px"><h3 style="margin:0 0 10px">查看互動紀錄</h3><div id="crmDetail">點「查看」以展開某位的完整互動紀錄。</div></section>
    </section>
  </div>

  <script src="app.js?v=v6.1.4"></script>
  <script>
    if ('serviceWorker' in navigator) {
      let refreshing = false;
      navigator.serviceWorker.addEventListener('controllerchange', () => {
        if (refreshing) return; refreshing = true; location.reload();
      });
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('service-worker.js?v=v6.1.4').then(reg => {
          if (reg.waiting) reg.waiting.postMessage({ type: 'SKIP_WAITING' });
        });
      });
    }
    console.log('IFNT v6.1.4 loaded');
  </script>
</body>
</html>
